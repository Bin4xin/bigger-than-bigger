# 影响版本


> 11.9 <=  GitLab（CE/EE）< 13.8.8
>
> 13.9 <=  GitLab（CE/EE）< 13.9.6
>
> 13.10 <= GitLab（CE/EE）< 13.10.3

# 复现

- Create a new snippet
- 登录创建一个仓库，并且创建新的`snippet`
- In the description field, hit "Attach a file"; Select and uplaod echo_vakzz.jpg
- [`echo_vakzz.jpg`](https://github.com/Bin4xin/bigger-than-bigger/blob/master/CoVV/Gitlab/CVE-2021-22205/echo_vakzz.jpg)上传附件
- See that the file `/tmp/bin4xin` has been created on the server

也可以通过未授权RCE，具体可以查看[(CVE-2021-22205)RCE - 七、手工复现-未授权](https://www.freebuf.com/articles/web/303375.html){:target="_blank"}

# 效果

![](./cve-2021-22205.gif)

# 参考

- [HackerOne - RCE when removing metadata with ExifTool](https://hackerone.com/reports/1154542){:target="_blank"}
- [GitLab 远程命令执行漏洞复现(CVE-2021-22205)](https://www.freebuf.com/articles/web/303375.html){:target="_blank"}